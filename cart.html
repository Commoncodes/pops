<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>POP MART</title>
  <link rel="stylesheet" href="cart.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
</head>
<body class="body-home">

  <!-- Navbar -->
<header class="navbar">
  <span class="search-icon" aria-label="Search">üîç</span>
  <input type="text" class="search-bar" placeholder="LABUBU">
  <div class="logo" onclick="location.href='home.html'">POP MART</div>
  <div class="icons">
    <img class="nav-icons" src="images/customerService.webp" alt="">
    <img class="nav-icons" src="images/headerUserIcon2.png" alt="">
    <img class="nav-icons" src="images/heart_circle.png" alt="">
    <img class="nav-icons cart" src="images/bag.png" alt="">
  
  </div>
  
        <div class="cart-box">
                <img class="cart" src="images/bag.png" alt="">
                        <span id="cart-badge" style="display:none; background:rgb(3, 3, 3);color:#fff;border-radius:50%;padding:2px 5px;font-size:8px; width: 16px; height: 16px;">1</span>

        </div>

  <button class="hamburger" aria-label="Open menu">&#9776;</button>
</header>

  <!-- Navigation Tabs -->
  <nav class="top-nav">
    <a href="#">NEW & FEATURED</a>
    <a href="#">CATEGORY</a>
    <a href="#">CHARACTER</a>
    <a href="#">ACCESSORIES</a>
    <a href="#">MEGA</a>
    <a href="#">STORE PICKUP</a>
    <a href="#">GIFT WITH PURCHASE</a>
  </nav>


  <div class="mobile-search">
      <input type="text" class=" search-input" placeholder="LABUBU">
  </div>

  <main class="container-main-home">
   

    <div class="folly">

   <main class="container-home">


<div id="cart-items">
    <div class="items" id="cart-item-template" style="display:none;">
        <img src="" alt="">
        <div class="cart-info">
             <h4></h4>
        <p class="price"></p>
        <p class="quantity-label">Quantity</p>
        <div class="quantity-box">
            <div class="plus-btn"><p>-</p></div>
            <p class="quantity-value">1</p>
            <div class="minus-btn"><p>+</p></div>
        </div>
        <p class="remove-cart" >Remove from cart</p>
        </div>
       
    </div>
</div>

    <div class="cart-box-main">
       
    <section class="section2">
       

      <div class="total-box">
        <h3>Order Summary</h3>
        <div class="divider"></div>
        <p class="total-price">Total: $0.00</p>
        <div class="divider"></div>
        <p class="shipping">Shipping: $0.00</p>
        <div class="divider"></div>
        <p class="grand-total">Grand Total: $0.00</p>

       

         <div class="divider"></div>

          <div class="payment-method">
  <p>Select Payment Method</p>
  <label class="payment-option">
   <div class="icon-holder" >
     <img src="images/btc.png" alt="Bitcoin" class="payment-icon">
    <span>Bitcoin</span>
   </div>
   

     <input type="radio" name="payment" checked>
  </label>
</div>
        <p class="amount-btc">Bitcoin: 0.00</p>
      </div>

      <button id="checkout-btn">
        Checkout
      </button>


    
    
          <div class="divider"></div>

          <h4>Store Pickup Policy</h4>

                    <div class="divider"></div>

    </section>
  


     
        </div>

    </div>

  
  </main>

  <div class="footer">
    <div class="social-box">
      <div class="follow-box">
        <h2>FOLLOW US ON</h2>
       <div class="social-icons">
        <a href="#"><img src="images/instagram.png" alt="Facebook"></a>
        <a href="#"><img src="images/facebook.png" alt="Twitter"></a>
        <a href="#"><img src="images/tiktok.png" alt="Instagram"></a>
       </div>
      </div>
    
      <div class="social-apps">
        <a href="#"><img src="images/Android_new.png" alt="Twitter"></a>
        <a href="#"><img src="images/ios.png" alt="Instagram"></a>
      </div>
    </div>

    <div class="footer-contents">
      <div class="join">
        <h3>
          JOIN THE COMMUNITY
        </h3>

        <p>
        Be the first to receive our new releases, special offers and more
        </p>
          <input type="text" placeholder="Your email address">
           <h4>
          CONTACT US
        </h4>
        <div class="contact-box">
          <div class="box1">
            <h5>Chat</h5>
            <p style="margin-bottom: 0rem;">Monday - Sunday 8:00am - 2:00am PDT</p>
          </div>
          <div class="box2">
                        <p>Chat with us</p>

          </div>
        </div>

        <div class="contact-box">
           <div class="box1">
            <h5>Email</h5>
            <p style="margin-bottom: 0rem;">na.support@popmart.com</p>
          </div>
          <div class="box2">
                        <p>Email us</p>

          </div>
        </div>

        <div class="country-box">
          <p style="padding: 0rem; margin: 0rem;">CHANGE COUNTRY/REGION</p>
        </div>


      </div>

      <div class="links-box">
          <div class="support">
        <h3>SUPPORT</h3>
        <p>FAQ</p>
         <p>SHIPPING INFO</p>
         <p>PRIVACY POLICY</p>
         <p>TRACK YOUR ORDER</p>
          <p>FIND A STORE</p>
           <p>RETURNS</p>
            <p>POP BLOCK</p>
             <p>ORDER FAILURE GUIDE</p>
              <p>EXCHANGE</p>
               <p>TERMS AND CONDITION</p>
               <p>AUTHENTICITY CHECK</p>
      </div>
      <div class="about">
        <h3>ABOUT US</h3>
        <p>NEWS</p>
         <p>ARTIST</p>
         <p>ABOUT POPMART</p>
         <p>INVESTORS RELATIONS</p>
          <p>CONTACT US</p>
           <p>CAREERS</p>
      </div>
      <div class="shop">
        <h3>SHOP</h3>
        
        <p>LAUNCH CALENDAR</p>
         <p>TRENDING</p>
         <p>BLIND BOXES</p>
         <p>MEGA COLLECTION</p>
          <p>ACCESSORIES</p>
           
      </div>
      </div>
    
    </div>
    
     <div class="reserved-box">
      <div class="follow-box">
       <p>2025 POP MART ALL RIGHTS RESERVED</p>
       </div>


        <div class="social-apps">
        <a href="#"><img src="images/mastercard.png" alt="master"></a>
        <a href="#"><img src="images/visa.png" alt="visa"></a>
      </div>
      </div>
    
     
    </div>


  </div>

  <nav class="bottom-nav">
  <a href="home.html">
      <img class="nav-icons" src="images/home_outlined.png" alt="">
      <span class="nav-label">Home</span>
  </a>

  <a href="categories.html">
      <img class="nav-icons" src="images/categories.png" alt="">
      <span class="nav-label">Category</span>
  </a>
  <a href="cart.html">
      <img class="nav-icons" src="images/bag_filled.png" alt="">
      <span class="nav-label">MY BAG</span>
  </a>
   <a href="profile.html">
    <img class="nav-icons" src="images/headerUserIcon2.png" alt="">
    <span class="nav-label">Me</span>
</a>
</nav>

<div id="checkout-modal" class="checkout-modal">
  <div class="modal-content">
    <h3>Send Bitcoin Payment</h3>
    <p>Wallet Address:</p>
    <div class="wallet-address" style="display: flex; align-items: center; justify-content: center; gap: 8px;">
  <span id="wallet-address-text">bc1qzcg7dlhh5s8jl9t0c5jjafwzsmmnde5kzgqv02</span>
  <img id="copy-wallet-btn" src="images/copy.png" alt="Copy" style="width:20px;cursor:pointer;" title="Copy address">
  <span id="copy-status" style="font-size: 0.9rem; color: #4caf50; margin-left: 6px; display: none;">Copied!</span>
</div>
   <div style="display: flex; flex-direction: column; align-items: center; margin: 1.5rem 0 0.5rem 0;">
  <div class="circle-timer">
    <svg id="progress-ring" width="100" height="100">
      <circle
        id="progress-ring-bg"
        cx="50" cy="50" r="45"
        stroke="#eee"
        stroke-width="4"
        fill="none"
      />
      <circle
        id="progress-ring-circle"
        cx="50" cy="50" r="45"
        stroke="#8e8e8e"
        stroke-width="4"
        fill="none"
        stroke-linecap="round"
        stroke-dasharray="282.743"
        stroke-dashoffset="0"
        transform="rotate(-90 50 50)"
      />
    </svg>
    <div id="payment-timer" class="timer-text">05:00</div>
  </div>
  <div id="payment-status" style="color: #888; font-size: 1rem; margin-top: 0.7rem; display: none;">Confirming payment...</div>
</div>
    <button id="payment-sent-btn">I've sent the payment</button>
  </div>
</div>


<script>
window.addEventListener('DOMContentLoaded', function() {
  const cartItemsDiv = document.getElementById('cart-items');
  const template = document.getElementById('cart-item-template');
  let cart = JSON.parse(localStorage.getItem('cart') || '{}');

  // Remove any previously rendered items except the template
  cartItemsDiv.querySelectorAll('.items:not(#cart-item-template)').forEach(el => el.remove());

  // Remove any "Your cart is empty." message
  cartItemsDiv.querySelectorAll('p').forEach(p => {
    if (p.textContent === 'Your cart is empty.') p.remove();
  });

  if (Object.keys(cart).length === 0) {
    cartItemsDiv.innerHTML += '<p>Your cart is empty.</p>';
    updateCartBadge();
    return;
  }

  Object.keys(cart).forEach(key => {
    const item = cart[key];
    if (!item.quantity) item.quantity = 1;
    const clone = template.cloneNode(true);
    clone.id = ""; // Remove id from clone
    clone.style.display = "";
    clone.setAttribute('data-key', key);
    clone.querySelector('img').src = item.img;
    clone.querySelector('img').alt = item.name;
    clone.querySelector('h4').textContent = item.name;
    clone.querySelector('.price').textContent = `$${(parseFloat(item.price.replace(/[^0-9.]/g, '')) * item.quantity).toFixed(2)}`;
    clone.querySelector('.quantity-value').textContent = item.quantity;

    // Quantity and remove logic
    const plusBtn = clone.querySelector('.plus-btn');
    const minusBtn = clone.querySelector('.minus-btn');
    const quantityValue = clone.querySelector('.quantity-value');
    const priceElem = clone.querySelector('.price');
    const removeBtn = clone.querySelector('.remove-cart');
    let unitPrice = parseFloat(item.price.replace(/[^0-9.]/g, ''));

    plusBtn.addEventListener('click', () => {
      if (item.quantity > 1) {
        item.quantity--;
        quantityValue.textContent = item.quantity;
        priceElem.textContent = `$${(unitPrice * item.quantity).toFixed(2)}`;
        cart[key] = item;
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartBadge();
            updateTotalPrice(); // add this

      }
    });

    minusBtn.addEventListener('click', () => {
      item.quantity++;
      quantityValue.textContent = item.quantity;
      priceElem.textContent = `$${(unitPrice * item.quantity).toFixed(2)}`;
      cart[key] = item;
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartBadge();
          updateTotalPrice(); // add this

    });

    removeBtn.addEventListener('click', () => {
      delete cart[key];
      localStorage.setItem('cart', JSON.stringify(cart));
      clone.remove();
      updateCartBadge();
      if (Object.keys(cart).length === 0) {
        cartItemsDiv.innerHTML += '<p>Your cart is empty.</p>';
      }
    });

    cartItemsDiv.appendChild(clone);
  });

  updateCartBadge();
      updateTotalPrice(); // add this

});

function updateCartBadge() {
  const cartBadge = document.getElementById('cart-badge');
  let cart = JSON.parse(localStorage.getItem('cart') || '{}');
  const count = Object.keys(cart).length;
  if (count > 0) {
    cartBadge.style.display = 'inline-block';
    cartBadge.textContent = count;
  } else {
    cartBadge.style.display = 'none';
  }
}


function updateTotalPrice() {
  let cart = JSON.parse(localStorage.getItem('cart') || '{}');
  let total = 0;
  Object.values(cart).forEach(item => {
    const unitPrice = parseFloat(item.price.replace(/[^0-9.]/g, ''));
    total += unitPrice * (item.quantity || 1);
  });
  document.querySelector('.total-price').textContent = `Total: $${total.toFixed(2)}`;
  document.querySelector('.grand-total').textContent = `Grand Total: $${total.toFixed(2)}`;

  // Fetch live BTC rate and update Bitcoin amount
fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd')
  .then(response => response.json())
  .then(data => {
    const btcRate = data.bitcoin.usd; // USD per 1 BTC
    const btcAmount = total / btcRate;
    document.querySelector('.amount-btc').textContent = `Bitcoin: ${btcAmount.toFixed(6)}`;
  })
  .catch(() => {
    document.querySelector('.amount-btc').textContent = `Bitcoin: N/A`;
  });
}
</script>
<script>
window.addEventListener('DOMContentLoaded', function() {
  // ...other code...
  const img = localStorage.getItem('productImg');
  const name = localStorage.getItem('productName');
  const price = localStorage.getItem('productPrice');
  const addToCartBtn = document.getElementById('add-to-cart-btn');
  const cartBadge = document.getElementById('cart-badge');
  const productKey = img; // unique per product

  let cart = JSON.parse(localStorage.getItem('cart') || '{}');
  let inCart = !!cart[productKey];

  function updateCartUI() {
    const count = Object.keys(cart).length;
    if (count > 0) {
      cartBadge.style.display = 'inline-block';
      cartBadge.textContent = count;
    } else {
      cartBadge.style.display = 'none';
    }
    addToCartBtn.textContent = inCart ? 'Remove from Cart' : 'Add to Cart';
  }
  updateCartUI();

  addToCartBtn.addEventListener('click', function() {
    inCart = !inCart;
    if (inCart) {
      cart[productKey] = {
        img: img,
        name: name,
        price: price
      };
    } else {
      delete cart[productKey];
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartUI();
  });
});
</script>

<script>
document.getElementById('checkout-btn').addEventListener('click', function(e) {
  if (e.target.textContent.trim().toLowerCase() === 'checkout') {
    document.getElementById('checkout-modal').classList.add('active');
  }
});

document.getElementById('payment-sent-btn').addEventListener('click', function() {
  this.style.display = 'none';

  const timerDiv = document.getElementById('payment-timer');
  const statusDiv = document.getElementById('payment-status');
  const ring = document.getElementById('progress-ring-circle');
  statusDiv.style.display = 'block';

  // Timer settings
  let timeLeft = 300; // 5 minutes in seconds
  const totalTime = 300;
  const radius = 45;
  const circumference = 2 * Math.PI * radius;
  ring.style.strokeDasharray = `${circumference}`;
  ring.style.strokeDashoffset = 0;

  function updateTimer() {
    const min = Math.floor(timeLeft / 60).toString().padStart(2, '0');
    const sec = (timeLeft % 60).toString().padStart(2, '0');
    timerDiv.textContent = `${min}:${sec}`;

    // Update circle
    const progress = timeLeft / totalTime;
    ring.style.strokeDashoffset = `${circumference * (1 - progress)}`;

    if (timeLeft > 0) {
      timeLeft--;
      setTimeout(updateTimer, 1000);
    } else {
      statusDiv.textContent = "Payment confirmation window expired.";
    }
  }
  updateTimer();
});

document.getElementById('copy-wallet-btn').addEventListener('click', function() {
  const walletText = document.getElementById('wallet-address-text').textContent;
  navigator.clipboard.writeText(walletText).then(function() {
    const status = document.getElementById('copy-status');
    status.style.display = 'inline';
    setTimeout(() => { status.style.display = 'none'; }, 1500);
  });
});
</script>
</body>
</html>
